(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[55],{zrVq:function(t,e,n){"use strict";n.r(e);var r,i,a=n("2Taf"),o=n.n(a),s=n("vZ4D"),c=n.n(s),l=n("MhPg"),u=n.n(l),p=n("l4Ni"),m=n.n(p),d=n("ujKo"),f=n.n(d),h=n("q1tI"),y=n.n(h),v=n("bKel"),g=n.n(v),b=n("qIgq"),I=n.n(b),k=(n("IzEo"),n("bx4M")),E=n("MuoO"),S=n("wd/R"),R=n.n(S),A=n("Hx5s"),D=n("sMR+"),w=n("wOmh"),C=n("C2ml"),T=n("8hbc");function x(t){var e=O();return function(){var n,r=f()(t);if(e){var i=f()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return m()(this,n)}}function O(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}var M,j=(r=Object(E["connect"])(function(t){var e=t.content,n=e.schemas,r=e.adminConfig,i=e.data,a=t.loading,o=t.user.currentUser;return{schemas:n,adminConfig:r,data:i,loading:a.effects["content/fetch"]||a.effects["content/fetchAll"],currentUser:o}}),g()(i=r(i=function(t){u()(n,t);var e=x(n);function n(){return o()(this,n),e.apply(this,arguments)}return c()(n,[{key:"componentDidMount",value:function(){var t=this.props,e=t.match.params.model,n=t.schemas,r=t.adminConfig;_.isEmpty(n)||_.isEmpty(r)||this.getList(this.displayInTree,e)}},{key:"componentWillReceiveProps",value:function(t){var e=this.props,n=e.match.params.model,r=e.adminConfig,i=t.match.params.model;n!==i&&this.getList((r[i]||{}).displayInTree,i)}},{key:"componentDidUpdate",value:function(t){var e=t.schemas,n=t.adminConfig,r=this.props,i=r.schemas,a=r.adminConfig,o=r.match.params.model;!_.isEmpty(e)&&!_.isEmpty(n)||_.isEmpty(i)||_.isEmpty(a)||this.getList(this.displayInTree,o)}},{key:"getList",value:function(t,e){var n=this.filters,r=this.props.dispatch;r(t?{type:"content/fetchAll",payload:{model:e,filters:n}}:{type:"content/fetch",payload:{model:e,filters:n,page:1,size:30}}),r({type:"content/statistics",payload:{model:e,filters:n}})}},{key:"render",value:function(){var t=this.props,e=t.data,n=t.schemas,r=t.loading,i=t.match.params.model,a=e[i]?e[i]:{list:[],pagination:{}};a.pagination&&(a.pagination.showTotal=function(t){return"\u5171".concat(t,"\u6761\u6570\u636e")});var o=this.modelAdmin,s=o.display,c=void 0===s?[Object(T["D"])(i)]:s,l=o.editable,u=o.modalForm,p=void 0===u||u,m=o.actions,d=o.listStyle,f=o.exportable,h=o.sortable,v=o.tableActions,g=o.sortKey,b=o.modalDetail,I=o.inlineActions,E=o.maxInlineActions,S=n[i]?n[i].displayName:"",R=Object(D["a"])(i);return y.a.createElement(A["b"],{title:"".concat(S,"\u5217\u8868"),key:S},y.a.createElement(C["a"],null,S),y.a.createElement(k["a"],null,this.permissions&&y.a.createElement(y.a.Fragment,null,this.permissions.includes("view")?y.a.createElement(R,{tableActions:v,data:a,loading:r,model:i,display:c,editable:l||[],inlineActions:I,maxInlineActions:E,modalForm:p,actions:m,listStyle:d,displayInTree:this.displayInTree,displayInSort:this.displayInSort,sortKey:g,exportable:f,sortable:h,modalDetail:b}):y.a.createElement(w["default"],null))))}},{key:"filters",get:function(){var t=this,e=this.props,n=e.location.query,r=e.schemas,i=[];if(_.isEmpty(r))return i;for(var a=function(){var e=s[o];c=I()(e,2);var n=c[0],r=c[1],a=t.modelSchema.fields.find(function(t){return t.name===n});if("datetime"===a.type){var l="YYYY/MM/DD",u=r.split(","),p=I()(u,2),m=p[0],d=p[1];i.push({field:n,value:[R()(m,l).toISOString(),R()(d,l).toISOString()],operator:"between"})}else i.push({field:n,value:r,operator:"="})},o=0,s=Object.entries(n);o<s.length;o++){var c;a()}return i}},{key:"model",get:function(){var t=this.props.match.params.model;return t}},{key:"modelAdmin",get:function(){var t=this.props.adminConfig;return t[this.model]||{}}},{key:"modelSchema",get:function(){var t=this.props,e=t.match.params.model,n=t.schemas;return n[e]}},{key:"displayInTree",get:function(){return!0===this.modelAdmin.displayInTree}},{key:"displayInSort",get:function(){return!0===this.modelAdmin.displayInSort}},{key:"permissions",get:function(){var t=this.props,e=t.currentUser.permissions,n=t.match.params.model;return!!e&&e.filter(function(t){return t.endsWith(n)}).map(function(t){return t.split("_")[0]})}}]),n}(h["PureComponent"]))||i)||i),q=j,K=n("7gdK");function P(t){var e=F();return function(){var n,r=f()(t);if(e){var i=f()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return m()(this,n)}}function F(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}var L=g()(M=function(t){u()(n,t);var e=P(n);function n(){return o()(this,n),e.apply(this,arguments)}return c()(n,[{key:"render",value:function(){var t=this.props.match.params.model;return y.a.createElement(y.a.Fragment,null,y.a.createElement(q,this.props),y.a.createElement(K["a"],{key:t,model:t}))}}]),n}(h["Component"]))||M;e["default"]=L}}]);